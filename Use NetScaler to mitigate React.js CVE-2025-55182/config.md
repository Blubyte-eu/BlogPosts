
# NetScaler Responder policies for mitigating CVE-2025-55182

Blog Post: https://www.blubyte.eu/blog/important-update-critical-security-vulnerability-called-react2shell


Expressions: 

```
add policy expression EXP_WAF_cve202555182 "HTTP.REQ.METHOD.EQ(POST) && (HTTP.REQ.HEADER(\"next-action\").EXISTS || HTTP.REQ.HEADER(\"rsc-action-id\").EXISTS || HTTP.REQ.HEADER(\"Content-Type\").TO_LOWER.CONTAINS(\"multipart/form-data\") || HTTP.REQ.HEADER(\"Content-Type\").TO_LOWER.CONTAINS(\"application/x-www-form-urlencoded\")) && (HTTP.REQ.BODY(50000000).TO_LOWER.CONTAINS(\"constructor:\") || HTTP.REQ.BODY(50000000).TO_LOWER.CONTAINS(\"__proto__:\") || HTTP.REQ.BODY(50000000).TO_LOWER.CONTAINS(\"prototype:\") || HTTP.REQ.BODY(50000000).TO_LOWER.CONTAINS(\"_response:\"))"

add policy expression EXP_WAF_cve202555182ver2 "HTTP.REQ.METHOD.EQ(POST) && (HTTP.REQ.HEADER(\"rsc-action-id\").EXISTS || HTTP.REQ.HEADER(\"Content-Type\").TO_LOWER.CONTAINS(\"multipart/form-data\") || HTTP.REQ.HEADER(\"Content-Type\").TO_LOWER.CONTAINS(\"application/x-www-form-urlencoded\")) && (HTTP.REQ.BODY(50000000).TO_LOWER.CONTAINS(\"constructor:\") || HTTP.REQ.BODY(50000000).TO_LOWER.CONTAINS(\"__proto__:\") || HTTP.REQ.BODY(50000000).TO_LOWER.CONTAINS(\"prototype:\") || HTTP.REQ.BODY(50000000).TO_LOWER.CONTAINS(\"_response:\"))"
```

Log Messages:

```
add audit messageaction AUDIT_WAF_cve202555182 WARNING "\"LOGTYPE=cve202555182 HOSTNAME=\" +  HTTP.REQ.HOSTNAME.SERVER + \" HTTP_REQ=\" +  HTTP.REQ.URL + \"  SRC_IP=\" +  CLIENT.IP.SRC  + \" DST_IP=\" +  CLIENT.IP.DST  + \" USER-AGENT=\" +  HTTP.REQ.HEADER(\"User-Agent\") + \" Location=\" + CLIENT.IP.SRC.LOCATION"

add audit messageaction AUDIT_WAF_cve202555182ver2 WARNING "\"LOGTYPE=cve202555182ver2 HOSTNAME=\" +  HTTP.REQ.HOSTNAME.SERVER + \" HTTP_REQ=\" +  HTTP.REQ.URL + \"  SRC_IP=\" +  CLIENT.IP.SRC  + \" DST_IP=\" +  CLIENT.IP.DST  + \" USER-AGENT=\" +  HTTP.REQ.HEADER(\"User-Agent\") + \" Location=\" + CLIENT.IP.SRC.LOCATION"
```

Responder Policies:
```
add responder policy RS_PL_WAF_cve202555182 EXP_WAF_cve202555182 DROP -logAction AUDIT_WAF_cve202555182
add responder policy RS_PL_WAF_cve202555182ver2 EXP_WAF_cve202555182ver2 DROP -logAction AUDIT_WAF_cve202555182ver2
```

The responder policies can be bound globally or to the impacted CS VS or LB VS.
Configure the policies with no action to verify any false positive hits in logging only. 


